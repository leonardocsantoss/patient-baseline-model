SELECT
    dp.subject_id, dp.sex, ic.icustay_admit_age as admit_age, ic.icustay_id,  to_char(ce_hr.charttime, 'YYYY-MM-DD') as charttime_date, to_char(ce_hr.charttime, 'HH24-MI-SS') as charttime_time, height, weight_first as weight, com.congestive_heart_failure, com.cardiac_arrhythmias, com.valvular_disease, com.pulmonary_circulation, com.peripheral_vascular, com.hypertension, com.paralysis, com.other_neurological, com.chronic_pulmonary, com.diabetes_uncomplicated, com.diabetes_complicated, com.hypothyroidism, com.renal_failure, com.liver_disease, com.peptic_ulcer, com.aids, com.lymphoma, com.metastatic_cancer, com.solid_tumor, com.rheumatoid_arthritis, com.coagulopathy, com.obesity, com.weight_loss, com.fluid_electrolyte, com.blood_loss_anemia, com.deficiency_anemias, com.alcohol_abuse, com.drug_abuse, com.psychoses, com.depression, ce_hr.itemid as hr, ce_hr.value1num as hr_value, ce_bp.itemid as bp, ce_bp.value1num as sbp_value, ce_rr.itemid as rr, ce_rr.value1num as rr_value, ce_bt.itemid as bt, ce_bt.value1num as bt_value, ce_gl.itemid as gl, ce_gl.value1num as gl_value, ce_co2.itemid as co2, ce_co2.value1num as co2_value
FROM
    mimic2v26.d_patients dp, mimic2v26.icustay_detail ic, mimic2v26.comorbidity_scores com, mimic2v26.chartevents ce_hr, mimic2v26.chartevents ce_bp, mimic2v26.chartevents ce_rr, mimic2v26.chartevents ce_bt, mimic2v26.chartevents ce_gl, mimic2v26.chartevents ce_co2
WHERE
    ce_hr.itemid in (211) and ce_bp.itemid in (6, 51, 455, 6701) and ce_rr.itemid in (618) and ce_bt.itemid in (676, 677) and ce_gl.itemid in (811, 1529) and (ce_bp.charttime = ce_hr.charttime) and ce_co2.itemid in (777) and (ce_rr.charttime = ce_bp.charttime) and  (ce_bt.charttime = ce_rr.charttime) and (ce_gl.charttime = ce_bt.charttime) and (ce_co2.charttime = ce_gl.charttime) and ce_hr.value1num is not null and ce_bp.value1num is not null and ce_rr.value1num is not null and ce_bt.value1num is not null and ce_gl.value1num is not null and  height is not null and weight_first is not null and  ce_co2.value1num is not null and  (ce_hr.subject_id = dp.subject_id) and (ce_bp.subject_id = dp.subject_id) and (ce_rr.subject_id = dp.subject_id) and (ce_bt.subject_id = dp.subject_id) and (ce_gl.subject_id = dp.subject_id) and (ce_co2.subject_id = dp.subject_id) and ce_hr.icustay_id is not null and ce_bp.icustay_id is not null and ce_rr.icustay_id is not null and ce_bt.icustay_id is not null and ce_gl.icustay_id is not null and ce_co2.icustay_id is not null and (ce_bp.icustay_id = ce_hr.icustay_id) and (ce_rr.icustay_id = ce_bp.icustay_id) and (ce_bt.icustay_id = ce_rr.icustay_id) and (ce_gl.icustay_id = ce_bt.icustay_id) and (ce_co2.icustay_id = ce_gl.icustay_id) and (ic.subject_id = dp.subject_id) and (ic.icustay_id = ce_hr.icustay_id) and  (ic.subject_id = com.subject_id) and (ic.hadm_id = com.hadm_id) and  ic.icustay_admit_age > 15
ORDER BY
    dp.subject_id, ce_hr.icustay_id, ce_hr.charttime, ce_hr.itemid